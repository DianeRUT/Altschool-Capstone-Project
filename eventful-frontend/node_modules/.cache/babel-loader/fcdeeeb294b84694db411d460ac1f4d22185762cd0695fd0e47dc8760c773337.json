{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{apiGetProfile,apiUpdateProfile}from'../services/apiService';import{useContext}from'react';import{AuthContext}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const[profile,setProfile]=useState({name:'',email:'',role:''});const[isEditing,setIsEditing]=useState(false);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();const{authToken,logout}=useContext(AuthContext);useEffect(()=>{const fetchProfile=async()=>{console.log('Token being sent:',authToken);try{const{success,data,message}=await apiGetProfile(authToken);console.log('API Response:',{success,data,message});if(success&&data){setProfile(data);}else{if(message==='Token is not valid'||message==='Unauthorized'){logout();navigate('/login');}else{setError(message);}}}catch(err){console.error('Fetch Profile Error:',err);setError('Failed to fetch profile');}finally{setLoading(false);}};fetchProfile();},[authToken,logout,navigate]);const handleInputChange=e=>{setProfile({...profile,[e.target.name]:e.target.value});};const handleUpdateProfile=async e=>{e.preventDefault();try{const{success,message}=await apiUpdateProfile(profile,authToken);if(success){alert('Profile updated successfully');setIsEditing(false);}else{setError(message);}}catch(err){setError('Failed to update profile');}};const handleLogout=()=>{logout();navigate('/login');};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});if(!profile||!profile.name){return/*#__PURE__*/_jsx(\"div\",{children:\"No profile data available\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Profile\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name:\"}),isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:profile.name,onChange:handleInputChange}):/*#__PURE__*/_jsx(\"p\",{children:profile.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"p\",{children:profile.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Role:\"}),/*#__PURE__*/_jsx(\"p\",{children:profile.role})]}),isEditing?/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdateProfile,children:\"Save\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(true),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","apiGetProfile","apiUpdateProfile","useContext","AuthContext","jsx","_jsx","jsxs","_jsxs","Profile","profile","setProfile","name","email","role","isEditing","setIsEditing","loading","setLoading","error","setError","navigate","authToken","logout","fetchProfile","console","log","success","data","message","err","handleInputChange","e","target","value","handleUpdateProfile","preventDefault","alert","handleLogout","children","className","type","onChange","onClick"],"sources":["C:/Users/fsindamb/OneDrive/Desktop/Diane_stuffs/Capstone Altschool Project/eventful-frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { apiGetProfile, apiUpdateProfile } from '../services/apiService';\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst Profile = () => {\r\n    const [profile, setProfile] = useState({\r\n        name: '',\r\n        email: '',\r\n        role: ''\r\n    });\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const navigate = useNavigate();\r\n    const { authToken, logout } = useContext(AuthContext);\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchProfile = async () => {console.log('Token being sent:', authToken);\r\n\r\n            try {\r\n                const { success, data, message } = await apiGetProfile(authToken);\r\n                console.log('API Response:', { success, data, message });\r\n                \r\n                if (success && data) {\r\n                    setProfile(data);\r\n                } else {\r\n                    if (message === 'Token is not valid' || message === 'Unauthorized') {\r\n                        logout();\r\n                        navigate('/login');\r\n                    } else {\r\n                        setError(message);\r\n                    }\r\n                }\r\n            } catch (err) {\r\n\r\n        console.error('Fetch Profile Error:', err);\r\n                setError('Failed to fetch profile');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        fetchProfile();\r\n    }, [authToken, logout, navigate]);\r\n\r\n    const handleInputChange = (e) => {\r\n        setProfile({ ...profile, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleUpdateProfile = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const { success, message } = await apiUpdateProfile(profile, authToken);\r\n            if (success) {\r\n                alert('Profile updated successfully');\r\n                setIsEditing(false);\r\n            } else {\r\n                setError(message);\r\n            }\r\n        } catch (err) {\r\n            setError('Failed to update profile');\r\n        }\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/login');\r\n    };\r\n\r\n    if (loading) return <div>Loading...</div>;\r\n    if (error) return <div>Error: {error}</div>;\r\n  \r\n    if (!profile || !profile.name) {\r\n        return <div>No profile data available</div>;\r\n    }    \r\n\r\n    return (\r\n        <div className=\"profile-container\">\r\n            <h2>Profile</h2>\r\n            <div>\r\n                <label>Name:</label>\r\n                {isEditing ? (\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"name\"\r\n                        value={profile.name}\r\n                        onChange={handleInputChange}\r\n                    />\r\n                ) : (\r\n                    <p>{profile.name}</p>\r\n                )}\r\n            </div>\r\n            <div>\r\n                <label>Email:</label>\r\n                <p>{profile.email}</p>\r\n            </div>\r\n            <div>\r\n                <label>Role:</label>\r\n                <p>{profile.role}</p>\r\n            </div>\r\n            {isEditing ? (\r\n                <button onClick={handleUpdateProfile}>Save</button>\r\n            ) : (\r\n                <button onClick={() => setIsEditing(true)}>Edit</button>\r\n            )}\r\n            <button onClick={handleLogout}>Logout</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Profile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}